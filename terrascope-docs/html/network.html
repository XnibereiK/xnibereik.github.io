
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Network &#8212; terrascope-ml  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Structure" href="structure.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="network">
<h1>Network<a class="headerlink" href="#network" title="Permalink to this heading">¶</a></h1>
<section id="architecture-overview">
<h2>Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permalink to this heading">¶</a></h2>
<p>In this section, we’ll briefly discuss the architecture of the UNetFormer to aid in making and understanding any future changes in the structure.
The easiest way to understand UNetFormer is by starting discussion with the traditional UNet.</p>
<a class="reference internal image-reference" href="_images/unet_architecture.png"><img alt="UNet-like architecture" src="_images/unet_architecture.png" style="width: 600px;" /></a>
<p>It has <strong>UNet-like symmetrical downscaling and upscaling paths</strong> (4 levels).</p>
<p><strong>Skip connections</strong> - the feature maps generated by each stage are fused with the corresponding feature maps of the decoder by a 1x1 convolution
along the channel dimension.</p>
<p>In CNN-based encoder, compared to UNet, the simple 2d convs are replaced with <strong>ResBlocks (currently using RenNet17)</strong> to take advantage of pre-trained models
to allow for deeper information encoding. This parameter can be easily changed in the network settings.</p>
<p>In Transformer-based decoder, the transpose convolutions are replaced with a <strong>GLTB (Global Local Transformer Block)</strong> shown in the figure below. Use of transformer
here is one of the novelties introduced by this research and it allows for much better context understanding thanks to efficient window-based multi-head
self-attention and cross-shaped window context interaction module.</p>
<a class="reference internal image-reference" href="_images/GLTB.png"><img alt="UNet-like architecture" src="_images/GLTB.png" style="width: 600px;" /></a>
</section>
<section id="losses">
<h2>Losses<a class="headerlink" href="#losses" title="Permalink to this heading">¶</a></h2>
<p>We have 2 types of losses, a <strong>principal loss</strong> that <strong>combines cross entropy and dice loss</strong>, and an <strong>auxiliary loss (cross entropy)</strong> pulled from each of the layers.
More precisely, the auxiliary head takes the fused feature of the three Global-Local Transformer blocks (as seen in the architecture overview image) as
the input and constructs a 3x3 convolution layer with batch normalization and ReLU, a 1x1 convolution layer and an upsampling operation
Finally, <strong>overall loss</strong> is the sum of principal and auxiliary (with a multiplication factor alpha).</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">terrascope-ml</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#losses">Losses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="structure.html" title="next chapter">Structure</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Terrascope.io Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/network.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>